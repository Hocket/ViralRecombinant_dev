# ViralRecombinant_dev

A toolkit for viral recombinant analysis, including SNP matching, phylogenetic tree construction, and data utilities.

## Folder Structure

```
Data/
  InputFiles/         # Input data files (FASTA, PED, etc.)
  IQTree_out/         # Output files from IQ-TREE runs
  OutputFiles/        # Output files generated by scripts
  requirements/       # Environment and package requirements
Code/
  matching.py         # SNP matching script
  run_matching.py     # Main script to run matching workflow
  SNPMatching.py      # SNP matching functions
  tree_utils.py       # Phylogenetic tree utilities
```

## Requirements

- Python 3.8.20+ (developed using 3.13.11)
- All Python packages listed in `Data/requirements/requirements.txt`
- [IQ-TREE](http://iqtree.github.io) (required for phylogenetic analysis)

### Installing IQ-TREE

If you are **not using Conda**, install IQ-TREE separately:

**macOS (Homebrew):**
```
brew install iqtree
```

**Other platforms:**  
Download binaries from the [IQ-TREE website](http://iqtree.github.io) and add to system path.
<br><sub>This may require additional troubleshooting, for this reason conda is preferred.</sub>

## Setup

### Using Conda (Recommended)

Create the environment with all dependencies (including IQ-TREE):

```
conda env create -f Data/requirements/environment.yml
conda activate viral_recombinant
```

### Using pip

Create Local Environment

```
python -m venv .venv
```
#### Activate Local Environment
##### **Windows**
```
.venv\Scripts\activate
```

##### **Unix / MacOS**
```
source .venv/bin/activate
```

#### Install Python packages:

```
pip install -r Data/requirements/requirements.txt
```

**Note:** You must install IQ-TREE separately if using pip (see above).

## Usage

1. Place your input files in `Data/InputFiles/`.
2. Run the main workflow script:

```
python Code/run_matching.py Data/InputFiles/<ped_file> Data/InputFiles/<recombinant_file> Data/InputFiles/<fasta_file>
```

3. Output files will be saved in `Data/OutputFiles/` and `Data/IQTree_out/`.

**Note:**  
Tree result files are generated in two versions: one with color annotations and one without. Some phylogenetic tree viewers may not display the colored .nexus files correctly. If you encounter issues, use .nwk the version without color.

## Scripts Overview

- `matching.py` — SNP matching logic
- `run_matching.py` — Main workflow script
- `tree_utils.py` — Utilities for phylogenetic tree analysis

## Citation

If you use this toolkit, please cite appropriately.

## License

[Specify your license here]

## Contact

For questions or issues, please contact [Alex Poyer](https://github.com/Hocket)

## References

**IQTree3:**<br>
  T.K.F. Wong, N. Ly-Trong, H. Ren, H. Banos, A.J. Roger, E. Susko, C. Bielow, N. De Maio, N. Goldman, M.W. Hahn, G. Huttley, R. Lanfear, B.Q. Minh (2025) IQ-TREE 3: Phylogenomic Inference Software using Complex Evolutionary Models. Submitted, https://doi.org/10.32942/X2P62N.

**Phylo (BioPython):**<br>
  Talevich E, Invergo BM, Cock PJ and Chapman BA (2012) Bio.Phylo: a unified toolkit for processing, analyzing and visualizing phylogenetic trees in Biopython. BMC Bioinformatics, 13, 209
